<?php
	//Favorites page - manages favorites
	include "loghead.php";
?>
<html>

<head>
<title>Favorites</title>
</head>
<br/><br/>

<div align=center>
<h1>Favorites</h1>
<?php
	$uname = $_SESSION['username'];
	$query = "Select * from user_favorites where user_id IN (select id from users where username='$uname')";
	$result = mysqli_query($db,$query);
	if(!($row = mysqli_fetch_array($result)))
	{
		echo "You have no Favorites!";
	}
	else
	{
		?>
		<table border="1">
		<tr><th>Title</th><th>Genre</th><th>*</th></tr>
		<?php
		$result = mysqli_query($db,$query);
		while($row = mysqli_fetch_array($result))
		{
			$gid = $row['game_id'];
			
			$query = "Select * from game_list where id='$gid'";
			
			$result2 = mysqli_query($db, $query) or die("something bad");
			$row2 = mysqli_fetch_array($result2);
		
			$id = $row2['id'];
			$game = $row2['game_name'];
  			$genre = $row2['genre'];
			$Url = $row2['url'];
			
			//Display whatever has been favorited so far
			
			echo "<tr><td><a href='$Url'>$game</a></td><td>
			$genre</td><td><a href='unfav.php?gameid=$id'>Unfavorite</a></td></tr>";
		}
		
		echo "</table>";
  	}
?>
</div>
</html>