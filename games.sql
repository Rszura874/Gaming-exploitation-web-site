DROP DATABASE IF EXISTS games;
CREATE DATABASE IF NOT EXISTS games;
USE games;

CREATE TABLE IF NOT EXISTS game_list
(
	id int(11) NOT NULL AUTO_INCREMENT,
	game_name varchar(50),
	genre varchar(30),
	url varchar(60),
	PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS	users
(
	id int(11) NOT NULL AUTO_INCREMENT,
	username varchar(50),
	firstname varchar(50),
	lastname varchar(50),
	password varchar(50),
	PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS user_favorites
(
	fav_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	user_id int(11),
	game_id int(11),
	CONSTRAINT users_user_id_fk
	FOREIGN KEY (user_id)
	REFERENCES users (id),
	CONSTRAINT game_list_game_id_fk
	FOREIGN KEY (game_id)
	REFERENCES game_list (id)
);

CREATE TABLE IF NOT EXISTS systems
(
	id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	sys_name varchar(20)
);

CREATE TABLE IF NOT EXISTS system_matches
(
	sys_id int(11),
	game_id int(11),
	CONSTRAINT systems_id_fk
	FOREIGN KEY (sys_id)
	REFERENCES systems (id),
	CONSTRAINT game_list_id_fk
	FOREIGN KEY (game_id)
	REFERENCES game_list (id),
	PRIMARY KEY (sys_id, game_id)
);

/*****************************************************
	Populate Tables
*****************************************************/
INSERT INTO game_list (game_name, genre, url) VALUES
('Final Fantasy XIII-2', 'RPG', 'ffXIII-2.txt'),
('Skyrim', 'RPG', 'skyrim.txt'),
('Runescape', 'MMO RPG', 'runescape.txt'),
('Left 4 Dead', 'Shooter', 'left4dead.txt'),
('Left 4 Dead 2', 'Shooter', 'left4dead2.txt'),
('Guitar Hero 3: Legends of Rock', 'Music', 'gh3.txt'),
('Rock Band','Music', 'rb.txt'),
('Rock Band 2', 'Music', 'rb2.txt'),
('Disgaea 4', 'RPG', 'd4.txt'),
('Demon Souls', 'RPG', 'demonsouls.txt'),
('Kingdom Hearts: Birth by Sleep', 'RPG', 'khbirthbysleep.txt'),
('Halo Reach', 'Shooter', 'haloreach.txt'),
('Assassin\'s Creed', 'Action/Adventure', 'assassin.txt');

INSERT INTO systems (sys_name) VALUES
('PC'),
('MAC'),
('X360'),
('PS2'),
('PS3'),
('PSP'),
('Wii');

INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Final Fantasy XIII-2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Skyrim') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Skyrim') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Skyrim') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Skyrim') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'MAC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Runescape') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Left 4 Dead') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Left 4 Dead') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Left 4 Dead') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'MAC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Left 4 Dead 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Left 4 Dead 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'MAC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Left 4 Dead 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Guitar Hero 3: Legends of Rock') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Guitar Hero 3: Legends of Rock') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'MAC') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Guitar Hero 3: Legends of Rock') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS2') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Guitar Hero 3: Legends of Rock') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Guitar Hero 3: Legends of Rock') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'Wii') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Guitar Hero 3: Legends of Rock') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS2') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'Wii') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS2') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Rock Band 2') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'Wii') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Disgaea 4') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Demon Souls') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Kingdom Hearts: Birth by Sleep') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PSP') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Halo Reach') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Assassin\'s Creed') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'X360') systems
	WHERE 1=1;
INSERT INTO system_matches (game_id, sys_id)
SELECT game_list.id, systems.id 
FROM (SELECT id FROM game_list WHERE game_name = 'Assassin\'s Creed') game_list, 
	(SELECT id FROM systems WHERE sys_name = 'PS3') systems
	WHERE 1=1;

	
CREATE INDEX IPK_game_list ON game_list(game_name);
CREATE INDEX IPK_user_favorites_uid ON user_favorites(user_id);
CREATE INDEX IPK_user_favorites_gid ON user_favorites(game_id);