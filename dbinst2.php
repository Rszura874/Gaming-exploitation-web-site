<?php
	$host = $_POST['hostname'];
	$user = $_POST['username'];
	$password = $_POST['password'];
	
	$link = mysqli_connect($host, $user, $password);
	//If connection fails, tell the user
	if (!$link) {
		echo( "<P>Unable to connect to the " .
			"database server at this time.</P>" );
		exit();
	}

	if(isset($_POST['replace'])) {
		$query = "DROP DATABASE IF EXISTS games";
		$result = mysqli_query($link, $query) 
			or die ('Invalid query: ' . mysqli_error($link));
	}
	//Database/Table Creation (currently the user_favorites
	//table does not work - foreign key constraint error)
	
	$query2 = <<<EOD
	CREATE DATABASE IF NOT EXISTS games;
	USE games;

	CREATE TABLE IF NOT EXISTS game_list
	(
		id int(11) NOT NULL AUTO_INCREMENT,
		game_name varchar(50),
		genre varchar(30),
		url varchar(60),
		PRIMARY KEY(id)
	);

	INSERT INTO game_list (id, game_name, genre, url) VALUES
	(1, 'Final Fantasy XIII-2', 'RPG', 'ffXIII-2.txt'),
	(2, 'Skyrim', 'RPG', 'skyrim.txt'),
	(3, 'Runescape', 'MMO RPG', 'runescape.txt'),
	(4, 'Left 4 Dead', 'Shooter', 'left4dead.txt'),
	(5, 'Left 4 Dead 2', 'Shooter', 'left4dead2.txt'),
	(6, 'Guitar Hero 3: Legends of Rock', 'Music', 'gh3.txt'),
	(7, 'Rock Band','Music', 'rb.txt'),
	(8, 'Rock Band 2', 'Music', 'rb2.txt'),
	(9, 'Disgaea 4', 'RPG', 'd4.txt'),
	(10, 'Demon Souls', 'RPG', 'demonsouls.txt'),
	(11, 'Kingdom Hearts Birth by Sleep', 'RPG', 'khbirthbysleep.txt'),
	(12, 'Halo Reach', 'Shooter', 'haloreach.txt'),
	(13, 'Assassin\'s Creed', 'Action/Adventure', 'assassin.txt');

	CREATE TABLE IF NOT EXISTS	users
	(
		id int(11) NOT NULL AUTO_INCREMENT,
		username varchar(50),
		firstname varchar(50),
		lastname varchar(50),
		password varchar(50),
		PRIMARY KEY(id)
	);

	CREATE TABLE IF NOT EXISTS user_favorites
	(
		user_id int(11),
		game_id int(11) NOT NULL AUTO_INCREMENT,
		CONSTRAINT users_user_id_fk
		FOREIGN KEY (user_id)
		REFERENCES users (id),
		CONSTRAINT game_list_game_id_fk
		FOREIGN KEY (game_id)
		REFERENCES game_list (id)
	);

	CREATE TABLE IF NOT EXISTS systems
	(
		id int(3),
		system_name varchar(20),
		PRIMARY KEY (id)
	);

	CREATE TABLE IF NOT EXISTS system_matches
	(
		sys_id int(3),
		game_id int(11),
		CONSTRAINT systems_id_fk
		FOREIGN KEY (sys_id)
		REFERENCES systems (id),
		CONSTRAINT game_list_id_fk
		FOREIGN KEY (game_id)
		REFERENCES game_list (id)
	);	
EOD;
		$result2 = mysqli_multi_query($link, $query2)
			or die('Invalid query: ' . mysqli_error($link));
			
?>
<html>
<div align=center>Thanks for installing! <br/>

<!-- Homepage button -->
<form method="post" action="home.php">
	<input type="submit" value="Go To Homepage" name="submit" />
</form>
</div>
</html>